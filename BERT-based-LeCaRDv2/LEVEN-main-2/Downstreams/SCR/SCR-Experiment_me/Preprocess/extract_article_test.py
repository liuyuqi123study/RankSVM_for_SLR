import json
import os
import pandas as pd
import numpy as np
csvfile=pd.read_csv('/Users/yuqi/Downloads/feature_test/features_v2_test_130.csv')
i=0

colu=[234, 67, 25, 47, 61, 196, 65, 36, 303, 27, 68, 64, 343, 26, 52, 53, 72, 73, 63, 238, 69, 272, 264, 141, 45, 37, 385, 386, 383, 93, 240, 236, 115, 266, 276, 354, 341, 347, 293, 356, 23, 57, 128, 70, 205, 143, 267, 292, 195, 224, 280, 345, 76, 277, 62, 359, 225, 77, 310, 389, 344, 99, 30, 31, 231, 382, 348, 48, 338, 71, 232, 133, 312, 263, 313, 55, 56, 397, 17, 81, 140, 150, 239, 307, 244, 12, 393, 384, 390, 125, 213, 18, 176, 114, 144, 275, 271, 340, 75, 387, 233, 351, 290, 274, 357, 50, 59, 42, 44, 342, 13, 322, 1, 20, 294, 192, 134, 245, 175, 237, 252, 24, 38, 41, 186, 269, 358, 158, 401, 58, 22, 151, 300, 388, 214, 6, 346, 74, 19, 193, 253, 163, 226, 86, 60, 194, 200, 396, 54, 198, 199, 349, 155, 153, 5, 309, 209, 399, 2, 11, 15, 177, 46, 352, 228, 119, 91, 83, 336, 164, 139, 43, 350, 102, 103, 39, 40, 14, 201, 337, 217, 219, 395, 392, 162, 247, 402, 220, 34, 160, 363, 375, 374, 147, 223, 118, 149, 148, 136, 324, 321, 7, 3, 189, 197, 243, 51, 35, 285, 97, 208, 168, 101, 291, 314, 282, 295, 29, 159, 212, 279, 241, 204, 261, 268, 89, 361, 235, 215, 170, 94, 191, 417, 315, 287, 49, 124, 328, 138, 316, 372, 258, 273, 365, 229, 156, 325, 88, 260, 4, 246, 171, 87, 360, 408, 413, 210, 305, 259, 284, 211, 180, 302, 28, 135, 333, 270, 286, 318, 106, 254, 281, 301, 391, 366, 85, 127, 172, 185, 132, 146, 278, 152, 353, 130, 308, 331, 207, 183, 407, 137, 221, 380, 288, 364, 184, 222, 154, 167, 248, 335, 242, 96, 418, 117, 230]
pd2=pd.DataFrame(np.zeros((len(csvfile),306)),columns=['a:'+ str(a) for a in colu])
for line in csvfile.values.tolist():
    cand_id=str(line[1][1:-1].split(',')[1].strip().strip("'"))
    with open(os.path.join('/Users/yuqi/Downloads/candidate_55192',str(cand_id)+'.json')) as f:
        cand=json.load(f)
        articles=cand['article']
        for a in articles:
            if a in colu:
                pd2.loc[i,'a:'+str(a)]=1
        i=i+1
csvfile=pd.concat([csvfile,pd2],axis=1)
csvfile.to_csv('/Users/yuqi/Downloads/feature_test/features_v2_test_130_articles.csv',index=False,header=True)
